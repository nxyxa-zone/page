<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIJ PRO: Network Engineer Mode</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: '#0f172a',      /* Slate 900 */
                        card: '#1e293b',      /* Slate 800 */
                        primary: '#06b6d4',   /* Cyan 500 */
                        secondary: '#8b5cf6', /* Violet 500 */
                        accent: '#10b981',    /* Emerald 500 */
                        alert: '#ef4444',     /* Red 500 */
                    },
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    animation: {
                        'pulse-fast': 'pulse 0.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Animations */
        .fade-in { animation: fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); scale: 0.95; } to { opacity: 1; transform: translateY(0); scale: 1; } }
        
        /* Tab Styles */
        .tab-active { background-color: #06b6d4; color: #0f172a; border-bottom: 4px solid #8b5cf6; font-weight: 700; transform: scale(1.02); box-shadow: 0 4px 6px -1px rgba(6, 182, 212, 0.3); }
        .tab-inactive { background-color: #1e293b; color: #94a3b8; font-weight: 500; border: 1px solid #334155; }
        
        /* Drag & Drop Styles (Puzzle) */
        .draggable-source { cursor: grab; transition: all 0.2s; }
        .draggable-source:active { cursor: grabbing; transform: scale(0.95); }
        .drop-zone { transition: all 0.3s; }
        .drop-zone.drag-over { background-color: rgba(6, 182, 212, 0.2); border-color: #06b6d4; transform: scale(1.02); }

        /* Game Button Styles */
        .game-btn-active { background-color: #10b981; color: #0f172a; border-color: #34d399; font-weight: bold; box-shadow: 0 0 10px rgba(16, 185, 129, 0.3); }
        .game-btn-inactive { background-color: #1e293b; color: #94a3b8; border-color: #334155; }
        
        /* Failover Game Specifics */
        .isp-btn { transition: all 0.1s; transform: scale(1); }
        .isp-btn:active { transform: scale(0.95); }
        
        /* Scrollbar for text areas */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body class="bg-dark font-sans text-slate-200 antialiased min-h-screen flex justify-center">

    <div class="w-full max-w-lg bg-dark shadow-2xl shadow-cyan-900/20 min-h-screen relative flex flex-col border-x border-slate-800">

        <header id="top-header" class="hidden relative h-64 overflow-hidden rounded-b-[40px] shadow-xl z-10 group bg-gradient-to-b from-slate-900 to-indigo-950">
            <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-30"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-dark via-transparent to-transparent"></div>
            
            <div class="absolute bottom-0 left-0 p-6 w-full">
                <div class="flex items-center gap-2 mb-2">
                    <span class="px-2 py-1 rounded bg-cyan-900/50 border border-cyan-500/30 text-cyan-400 text-[10px] font-mono font-bold">XII TKJ ‚Ä¢ AIJ ‚Ä¢ FASE F</span>
                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse shadow-[0_0_10px_#10b981]"></span>
                    <span class="text-[10px] text-green-400 font-mono">SYSTEM: ONLINE</span>
                </div>
                <h1 class="text-3xl font-bold leading-tight mb-1 text-white">Load Balancing <br><span class="text-cyan-400 font-mono text-2xl">_Configuration</span></h1>
                
                <div class="flex items-center justify-between mt-4 bg-slate-800/50 p-3 rounded-xl border border-slate-700 backdrop-blur-md">
                    <div class="flex items-center gap-3">
                        <div class="bg-slate-900 p-1 rounded-lg shadow-lg h-10 w-10 flex items-center justify-center border border-slate-600">
                             <i class="fas fa-network-wired text-cyan-500 text-2xl"></i>
                        </div>
                        <div class="flex flex-col">
                            <span class="text-[10px] text-slate-400 uppercase tracking-widest font-mono">Teacher / SysAdmin</span>
                            <span class="text-sm font-bold text-white">Bapak Guru TKJ</span>
                        </div>
                    </div>
                    <button onclick="openAdminModal()" class="text-slate-500 hover:text-cyan-400 transition-colors p-2">
                        <i class="fas fa-terminal"></i>
                    </button>
                </div>
            </div>
        </header>

        <section id="identity-section" class="flex-grow p-8 flex flex-col justify-center fade-in">
            <div class="text-center mb-8 relative">
                <div class="absolute inset-0 flex items-center justify-center opacity-20">
                    <i class="fas fa-shield-alt text-9xl text-cyan-800"></i>
                </div>
                <div class="inline-block p-4 rounded-full bg-slate-800 border border-slate-700 mb-4 shadow-lg text-cyan-400 text-3xl relative z-10">
                    <i class="fas fa-fingerprint"></i>
                </div>
                <h2 class="text-xl font-bold text-white font-mono relative z-10">Auth_User_Login</h2>
                <p class="text-slate-400 text-sm mt-1 relative z-10">Masukkan identitas untuk akses Laboratorium Virtual.</p>
            </div>

            <form id="identity-form" class="space-y-5 relative z-10">
                <div class="space-y-2">
                    <label class="text-xs font-bold text-cyan-500 font-mono ml-1"><i class="fas fa-user mr-1"></i> USERNAME / NAMA</label>
                    <input type="text" id="student-name" class="w-full px-5 py-3 rounded-lg bg-slate-800 border border-slate-700 focus:border-cyan-500 transition-all outline-none font-medium text-white placeholder-slate-600" placeholder="Nama Lengkap..." required>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-2">
                        <label class="text-xs font-bold text-cyan-500 font-mono ml-1"><i class="fas fa-users mr-1"></i> KELAS</label>
                        <select id="student-class" class="w-full px-5 py-3 rounded-lg bg-slate-800 border border-slate-700 focus:border-cyan-500 transition-all outline-none font-medium text-white">
                            <option>XII TKJ 1</option>
                            <option>XII TKJ 2</option>
                            <option>XII TKJ 3</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                        <label class="text-xs font-bold text-cyan-500 font-mono ml-1"><i class="fas fa-list-ol mr-1"></i> NO. ABSEN</label>
                        <input type="number" id="student-number" class="w-full px-5 py-3 rounded-lg bg-slate-800 border border-slate-700 focus:border-cyan-500 transition-all outline-none font-medium text-white placeholder-slate-600" placeholder="00" required>
                    </div>
                </div>
                <button type="submit" class="w-full bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-4 rounded-lg shadow-lg mt-6 flex justify-center items-center gap-3 font-mono border-b-4 border-cyan-800 transition-transform active:scale-95">
                    <span>INITIALIZE LAB</span> <i class="fas fa-power-off"></i>
                </button>
            </form>
        </section>

        <main id="main-content" class="hidden flex-col flex-grow bg-dark relative z-20">
            
            <div class="flex text-sm text-center bg-slate-900 shadow-lg sticky top-0 z-30 mx-4 mt-4 rounded-xl overflow-hidden p-1 gap-1 border border-slate-800" id="tabs">
                <button onclick="switchTab('konsep')" id="tab-konsep" class="flex-1 py-2 rounded-lg transition-all duration-300 font-mono text-[10px] md:text-xs">Konsep üåê</button>
                <button onclick="switchTab('algo')" id="tab-algo" class="flex-1 py-2 rounded-lg transition-all duration-300 font-mono text-[10px] md:text-xs">Algo üîÄ</button>
                <button onclick="switchTab('simulasi')" id="tab-simulasi" class="flex-1 py-2 rounded-lg transition-all duration-300 font-mono text-[10px] md:text-xs text-yellow-400">Games üïπÔ∏è</button>
                <button onclick="switchTab('config')" id="tab-config" class="flex-1 py-2 rounded-lg transition-all duration-300 font-mono text-[10px] md:text-xs">Config ‚öôÔ∏è</button>
            </div>

            <div class="p-6 space-y-8 pb-32">
                
                <section class="fade-in bg-indigo-950/30 border-l-4 border-indigo-500 p-4 rounded-r-lg shadow-lg relative overflow-hidden">
                     <div class="absolute right-0 top-0 p-2 opacity-10"><i class="fas fa-bullseye text-6xl text-indigo-400"></i></div>
                     <h3 class="text-[10px] font-bold text-indigo-400 uppercase font-mono mb-1 tracking-widest z-10 relative">üéØ Capaian Pembelajaran</h3>
                     <p class="text-xs md:text-sm text-indigo-100 italic relative z-10 leading-relaxed" id="cp-text">
                         </p>
                </section>

                <section id="standard-content" class="fade-in">
                    <div class="flex items-center gap-3 mb-4 pl-1">
                        <div class="w-1 h-6 bg-cyan-500 rounded-full"></div>
                        <h2 class="text-lg font-bold text-white font-mono uppercase" id="material-title">Judul Materi</h2>
                    </div>
                    
                    <div class="bg-slate-900 rounded-xl overflow-hidden shadow-2xl mb-4 aspect-video relative group border border-slate-800">
                        <div class="loader absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-0">
                            <i class="fas fa-circle-notch fa-spin text-cyan-500 text-3xl"></i>
                        </div>
                        <iframe id="video-embed" class="w-full h-full relative z-10" src="" title="Materi Video" frameborder="0" allowfullscreen></iframe>
                    </div>

                    <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700 text-sm text-slate-300 leading-relaxed shadow-sm mb-6 flex gap-3">
                        <i class="fas fa-info-circle text-cyan-500 mt-1 shrink-0"></i>
                        <p id="video-desc" class="italic font-mono text-xs"></p>
                    </div>

                    <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 relative overflow-hidden shadow-lg mb-6">
                        <div class="absolute top-0 right-0 p-3 opacity-5"><i class="fas fa-file-code text-5xl"></i></div>
                        <h4 class="font-bold text-cyan-400 mb-4 font-mono"><i class="fas fa-code mr-2"></i>Knowledge Base:</h4>
                        <ul class="space-y-3" id="key-points"></ul>
                    </div>

                    <section class="bg-slate-800 p-5 rounded-xl border border-slate-700 mb-6">
                        <h3 class="font-bold font-mono text-secondary mb-3"><i class="fas fa-book mr-2"></i>Terminology</h3>
                        <div class="grid gap-3 text-sm" id="glossary-container"></div>
                    </section>

                    <section class="bg-slate-900 p-1 rounded-lg border border-slate-700">
                         <div class="bg-slate-800 rounded p-4">
                            <h2 class="text-sm font-bold text-white font-mono mb-3"><i class="fas fa-edit mr-2 text-yellow-500"></i>Exam Simulation (5 Soal)</h2>
                            <div id="quiz-container" class="space-y-4"></div>
                        </div>
                    </section>
                </section>

                <section id="game-center" class="hidden fade-in">
                    
                    <div class="flex gap-2 mb-6 overflow-x-auto pb-2 scrollbar-hide">
                        <button onclick="switchGame('puzzle')" id="btn-game-puzzle" class="flex-1 py-2 px-3 rounded border text-[10px] font-mono whitespace-nowrap game-btn-active">Puzzle üß©</button>
                        <button onclick="switchGame('cli')" id="btn-game-cli" class="flex-1 py-2 px-3 rounded border text-[10px] font-mono whitespace-nowrap game-btn-inactive">CLI Rush ‚å®Ô∏è</button>
                        <button onclick="switchGame('failover')" id="btn-game-failover" class="flex-1 py-2 px-3 rounded border text-[10px] font-mono whitespace-nowrap game-btn-inactive">Reflex ‚ö°</button>
                    </div>

                    <div id="game-puzzle-area" class="fade-in">
                        <div class="bg-slate-900 rounded-xl border border-slate-700 p-4">
                            <h3 class="font-bold text-yellow-400 font-mono text-sm mb-2"><i class="fas fa-puzzle-piece"></i> Visual Config Builder</h3>
                            <p class="text-xs text-slate-400 mb-4">Susun blok script untuk logika <strong>Failover (Check Gateway)</strong>. Urutan harus benar!</p>
                            
                            <div class="flex flex-wrap gap-2 mb-6 bg-slate-800 p-3 rounded-lg min-h-[60px]" id="source-container">
                                <div draggable="true" class="draggable-source bg-red-900/50 border border-red-500 text-red-300 px-3 py-2 rounded text-xs font-mono select-none" data-id="1">/ip route add</div>
                                <div draggable="true" class="draggable-source bg-blue-900/50 border border-blue-500 text-blue-300 px-3 py-2 rounded text-xs font-mono select-none" data-id="2">dst-address=0.0.0.0/0</div>
                                <div draggable="true" class="draggable-source bg-green-900/50 border border-green-500 text-green-300 px-3 py-2 rounded text-xs font-mono select-none" data-id="3">gateway=8.8.8.8</div>
                                <div draggable="true" class="draggable-source bg-purple-900/50 border border-purple-500 text-purple-300 px-3 py-2 rounded text-xs font-mono select-none" data-id="4">check-gateway=ping</div>
                                <div draggable="true" class="draggable-source bg-yellow-900/50 border border-yellow-500 text-yellow-300 px-3 py-2 rounded text-xs font-mono select-none" data-id="5">distance=1</div>
                            </div>

                            <div class="relative">
                                <div class="absolute top-0 left-0 bg-slate-700 text-slate-300 text-[10px] px-2 py-1 rounded-br z-10 font-mono">Terminal Script Preview</div>
                                <div id="target-container" class="drop-zone w-full h-32 bg-black border-2 border-dashed border-slate-600 rounded-lg flex flex-wrap items-center content-start p-8 gap-2 font-mono text-sm text-green-400">
                                    <span class="text-slate-600 pointer-events-none select-none" id="placeholder-text">// Drag Code Here...</span>
                                </div>
                            </div>
                            <div id="puzzle-feedback" class="mt-3 text-xs font-mono font-bold text-center hidden"></div>
                        </div>
                    </div>

                    <div id="game-cli-area" class="hidden fade-in">
                        <div class="bg-black rounded-xl border-2 border-green-500/50 p-6 relative overflow-hidden">
                            <div class="absolute inset-0 bg-[url('https://media.giphy.com/media/26tn33aiTi1jbp6x2/giphy.gif')] opacity-10 bg-cover pointer-events-none"></div>

                            <div class="flex justify-between items-center mb-6 relative z-20">
                                <h3 class="font-bold text-green-500 font-mono text-sm"><i class="fas fa-terminal"></i> LB COMMAND RUSH</h3>
                                <div class="text-[10px] text-green-400 font-mono">SCORE: <span id="cli-score" class="text-xl">0</span></div>
                            </div>
                            <p class="text-green-800 text-xs font-mono mb-1 relative z-20">TYPE THIS COMMAND:</p>
                            <div class="bg-slate-900 border border-green-900 p-2 rounded mb-4 text-center relative z-20">
                                <span id="cli-target" class="text-lg font-bold text-white font-mono tracking-wider select-none">ip route print</span>
                            </div>
                            <div class="relative z-20">
                                <span class="absolute left-3 top-3 text-green-600 font-mono font-bold">></span>
                                <input type="text" id="cli-input" class="w-full bg-black border border-green-700 text-green-400 font-mono p-3 pl-8 rounded focus:outline-none uppercase placeholder-green-900" placeholder="TYPE HERE..." autocomplete="off" disabled>
                            </div>
                            <div class="w-full h-1 bg-green-900 mt-4 relative z-20"><div id="cli-timer-bar" class="h-full bg-green-400 w-full"></div></div>
                            <div id="cli-message" class="text-center mt-2 h-4 text-[10px] font-mono text-red-500 relative z-20"></div>
                            <button onclick="startCliGame()" id="btn-start-cli" class="w-full bg-green-700 hover:bg-green-600 text-white font-bold py-2 rounded mt-4 font-mono text-xs relative z-20">START SESSION</button>
                        </div>
                    </div>

                    <div id="game-failover-area" class="hidden fade-in">
                        <div class="bg-slate-900 rounded-xl border border-slate-700 p-4">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-red-400 font-mono text-sm"><i class="fas fa-random"></i> Failover Reflex</h3>
                                <div class="text-[10px] text-slate-400 font-mono">Packets Sent: <span id="failover-score" class="text-red-400 font-bold">0</span></div>
                            </div>
                            
                            <div class="text-[10px] text-slate-400 mb-4 bg-black/50 p-2 rounded border border-slate-700">
                                <p><span class="text-cyan-400 font-bold">MISSION:</span> Kirim trafik ke <span class="text-green-400">ISP AKTIF</span>.</p>
                                <ul class="list-disc ml-4 mt-1">
                                    <li>ISP 1 (Primary) = Prioritas Utama (Distance 1).</li>
                                    <li>ISP 2 (Backup) = Hanya jika ISP 1 Offline (Merah).</li>
                                    <li>Jika ISP 1 Online lagi, <strong>WAJIB</strong> pindah balik ke ISP 1!</li>
                                </ul>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4 text-center">
                                <div id="isp1-container" class="relative">
                                    <div id="isp1-status" class="mb-2 text-xs font-bold bg-green-900 text-green-400 py-1 rounded">ISP 1: ONLINE</div>
                                    <button onclick="routePacket(1)" id="btn-isp1" class="isp-btn w-full h-32 bg-slate-800 border-2 border-green-500 rounded-lg flex flex-col items-center justify-center gap-2 hover:bg-slate-700 group relative overflow-hidden">
                                        <div class="absolute inset-0 bg-green-500/10 group-hover:bg-green-500/20 transition-colors"></div>
                                        <i class="fas fa-server text-3xl text-slate-200 z-10"></i>
                                        <span class="text-xs font-bold text-white z-10">PRIMARY</span>
                                        <span class="text-[10px] text-slate-400 z-10">Distance: 1</span>
                                    </button>
                                </div>
                                
                                <div id="isp2-container" class="relative">
                                    <div id="isp2-status" class="mb-2 text-xs font-bold bg-yellow-900 text-yellow-400 py-1 rounded">ISP 2: STANDBY</div>
                                    <button onclick="routePacket(2)" id="btn-isp2" class="isp-btn w-full h-32 bg-slate-800 border-2 border-yellow-500 rounded-lg flex flex-col items-center justify-center gap-2 hover:bg-slate-700 group relative overflow-hidden">
                                        <div class="absolute inset-0 bg-yellow-500/10 group-hover:bg-yellow-500/20 transition-colors"></div>
                                        <i class="fas fa-server text-3xl text-slate-200 z-10"></i>
                                        <span class="text-xs font-bold text-white z-10">BACKUP</span>
                                        <span class="text-[10px] text-slate-400 z-10">Distance: 2</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div id="failover-msg" class="text-center mt-3 text-xs font-bold h-4 text-white"></div>
                            
                            <button onclick="startFailoverGame()" id="btn-start-failover" class="w-full bg-red-700 hover:bg-red-600 text-white font-bold py-2 rounded mt-4 font-mono text-xs shadow-[0_0_15px_rgba(185,28,28,0.4)]">START ROUTING</button>
                        </div>
                    </div>

                </section>

                <section class="fade-in bg-slate-800 p-6 rounded-xl border border-slate-700 mt-6">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h3 class="font-bold text-white text-sm font-mono"><i class="fas fa-user-astronaut text-yellow-500 mr-2"></i>Profil Pelajar Pancasila</h3>
                            <p class="text-[10px] text-slate-400 mt-1">Refleksi Soft Skill & Budaya Kerja</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 gap-3" id="p5-checklist-container">
                        </div>
                </section>

                <section class="fade-in mt-6">
                    <div class="bg-slate-900 p-1 rounded-lg border border-slate-700">
                         <div class="bg-slate-800 rounded p-4">
                            <h3 class="font-bold text-white text-sm font-mono mb-2"><i class="fas fa-edit text-cyan-500 mr-2"></i>Catatan / Laporan Kendala</h3>
                            <textarea id="input-refleksi" class="w-full bg-transparent text-slate-300 font-mono text-xs h-20 outline-none resize-none placeholder-slate-600 border-none focus:ring-0" placeholder="Tulis kendala konfigurasi atau strategi game kamu disini..."></textarea>
                        </div>
                    </div>
                </section>

                <div class="pt-6 pb-6">
                    <button onclick="submitLKPD()" class="w-full bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-4 rounded-xl shadow-lg transition-all flex justify-between items-center px-6 group border-b-4 border-cyan-800 active:border-b-0 active:translate-y-1">
                        <div class="flex flex-col items-start">
                            <span class="text-[10px] text-cyan-200 font-mono uppercase tracking-wider">Project Done?</span>
                            <span class="text-base font-bold">Submit Report via WhatsApp</span>
                        </div>
                        <div class="bg-white text-cyan-600 w-10 h-10 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform"><i class="fab fa-whatsapp text-xl"></i></div>
                    </button>
                </div>
            </div>
        </main>

        <div id="teacher-dashboard" class="hidden fixed inset-0 bg-dark z-50 overflow-y-auto">
            <div class="bg-slate-900 border-b border-slate-700 text-white p-5 sticky top-0 z-50 shadow-lg">
                <div class="flex justify-between items-center max-w-2xl mx-auto w-full">
                    <div>
                        <p class="text-[10px] text-cyan-500 uppercase tracking-widest font-mono">Root Access Granted</p>
                        <h2 class="text-lg font-bold text-white"><i class="fas fa-server mr-2"></i>Teacher Console</h2>
                    </div>
                    <button onclick="closeDashboard()" class="bg-red-500/20 text-red-500 p-2 rounded hover:bg-red-500 hover:text-white transition"><i class="fas fa-times"></i></button>
                </div>
            </div>
            <div class="p-5 space-y-6 max-w-2xl mx-auto pb-24 text-slate-300">
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700">
                    <h3 class="font-bold text-blue-400 mb-3 flex justify-between font-mono">
                        <span><i class="fas fa-database mr-2"></i>Log Data Siswa</span>
                        <button onclick="clearData()" class="text-[10px] bg-red-900/50 text-red-400 px-2 py-1 rounded hover:bg-red-900">Flush DB</button>
                    </h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs text-left text-slate-400 font-mono">
                            <thead class="text-slate-500 uppercase bg-slate-900"><tr><th class="px-4 py-2">User</th><th class="px-4 py-2">Score Info</th></tr></thead>
                            <tbody id="student-data-body">
                                </tbody>
                        </table>
                        <p id="no-data-msg" class="text-center text-xs p-4 text-slate-600">No logs found in temporary storage.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="admin-modal" class="hidden fixed inset-0 bg-black/90 z-[60] flex items-center justify-center p-4 backdrop-blur-sm modal">
            <div class="bg-slate-900 rounded-lg p-8 w-full max-w-sm text-center border border-green-500/30 shadow-[0_0_30px_rgba(16,185,129,0.2)]">
                <button onclick="closeAdminModal()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fas fa-times"></i></button>
                <div class="text-green-500 text-4xl mb-2"><i class="fas fa-user-shield"></i></div>
                <h3 class="text-xl font-bold text-white font-mono mb-4">ROOT ACCESS</h3>
                <input type="password" id="admin-pin" class="w-full text-center text-xl font-mono bg-black border border-slate-700 text-green-500 py-2 mb-6 rounded focus:ring-2 focus:ring-green-500 outline-none" placeholder="PIN: 270302">
                <button onclick="checkPin()" class="w-full bg-green-700 hover:bg-green-600 text-white font-bold py-3 rounded font-mono shadow-lg transition-transform active:scale-95">ENTER >_</button>
            </div>
        </div>

        <footer class="bg-dark border-t border-slate-800 p-8 text-center pb-10">
            <div class="flex flex-col items-center justify-center gap-2">
                <p class="text-xs text-slate-500 font-mono">Modul Ajar Digital AIJ - Fase F SMK</p>
                <div class="text-xs text-slate-600 font-medium flex items-center gap-1 bg-slate-900 px-3 py-1 rounded border border-slate-800">
                    <span>Dev by</span>
                    <a href="https://instagram.com/nxyxa.27" target="_blank" class="text-cyan-600 font-bold hover:text-cyan-400 flex items-center gap-1">@NxyxA <i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // === 1. DATA KONTEN LENGKAP (MATERI KATA-KATA) ===
        const contentData = {
            konsep: {
                title: "Konsep Load Balancing üåê",
                cp: "Peserta didik mampu memahami konsep manajemen bandwidth, Load Balancing, dan Failover untuk High Availability jaringan.",
                video: "https://www.youtube.com/embed/PysqJ_Ue7us", // Ganti dengan link video materi yang sesuai
                videoDesc: "Video ini menjelaskan perbedaan mendasar antara membagi beban (Load Balance) dan jalur cadangan (Failover).",
                glossary: [
                    { term: "Load Balancing", def: "Teknik mendistribusikan beban trafik ke dua atau lebih jalur koneksi secara seimbang." }, 
                    { term: "Failover", def: "Mekanisme otomatis memindahkan jalur ke link cadangan saat link utama mati (Down)." },
                    { term: "High Availability", def: "Sistem yang terus menerus beroperasi tanpa henti dalam waktu lama." },
                    { term: "Throughput", def: "Jumlah data yang benar-benar terkirim dalam satu waktu." }
                ],
                points: [
                    "Optimalisasi Resource: Mencegah satu ISP overload sementara ISP lain menganggur.",
                    "Redundansi: Menjaga internet tetap ON meskipun salah satu ISP gangguan.",
                    "Fleksibilitas: Dapat menggabungkan kecepatan dari 2 ISP berbeda (Aggregation).",
                    "Tidak menambah kecepatan 1 user, tapi menambah kapasitas total jaringan."
                ],
                quiz: [
                    { q: "Apa tujuan utama Load Balancing?", opts: ["Menghemat Kuota", "Membagi Beban Trafik", "Memblokir Situs"], ans: 1, exp: "Load Balancing bertujuan mendistribusikan trafik agar tidak menumpuk di satu jalur." },
                    { q: "Jika ISP A mati, trafik pindah ke ISP B. Disebut apa?", opts: ["Load Balance", "Bandwidth Test", "Failover"], ans: 2, exp: "Failover adalah pemindahan jalur otomatis saat gangguan." }
                ]
            },
            algo: {
                title: "Algoritma Penyeimbang üîÄ",
                cp: "Peserta didik mampu mengevaluasi penggunaan algoritma Round Robin, PCC, dan ECMP dalam studi kasus.",
                video: "https://www.youtube.com/embed/5dJ7d6t29jg", 
                videoDesc: "Analisis mendalam mengenai metode PCC vs Round Robin.",
                glossary: [
                    { term: "ECMP", def: "Equal Cost Multi Path. Load balancing sederhana menggunakan gateway ganda." }, 
                    { term: "PCC", def: "Per Connection Classifier. Mengelompokkan trafik berdasarkan kriteria (src-address, dst-address, dll)." },
                    { term: "Round Robin", def: "Algoritma giliran. Paket 1 ke ISP A, Paket 2 ke ISP B, dst." },
                    { term: "Sticky Connection", def: "Memastikan satu user selalu lewat jalur yang sama agar sesi aman (Banking)." }
                ],
                points: [
                    "Round Robin: Adil secara hitungan paket, tapi bisa merusak sesi login (Secure Web Error).",
                    "PCC (Src-Address): User A selalu lewat ISP 1, User B selalu lewat ISP 2. Stabil untuk browsing.",
                    "ECMP: Paling mudah dikonfigurasi, tapi kurang stabil untuk trafik HTTPS.",
                    "NTH: Metode penghitung paket ke-N (jarang dipakai sekarang)."
                ],
                quiz: [
                    { q: "Metode mana yang paling aman untuk E-Banking?", opts: ["Round Robin", "PCC (Src-Address)", "Random"], ans: 1, exp: "PCC Src-Address menjaga IP publik user tetap konsisten." },
                    { q: "ECMP singkatan dari?", opts: ["Equal Cost Multi Path", "Electronic Card Multi Pay", "Error Checking Multi Port"], ans: 0, exp: "Equal Cost Multi Path." }
                ]
            },
            simulasi: { 
                title: "Game Center üïπÔ∏è", 
                cp: "Peserta didik mampu mengasah logika scripting, kecepatan mengetik CLI, dan insting failover melalui simulasi gamifikasi.",
                points: [], glossary: [], quiz: [] 
            },
            config: {
                title: "Konfigurasi Mikrotik ‚öôÔ∏è",
                cp: "Peserta didik mampu melakukan konfigurasi Load Balancing metode PCC dan Failover Check Gateway.",
                video: "https://www.youtube.com/embed/HuK6dWyK1XU", 
                videoDesc: "Tutorial langkah demi langkah konfigurasi PCC di Winbox.",
                glossary: [
                    { term: "Mangle", def: "Fitur Firewall untuk menandai (marking) paket data." }, 
                    { term: "Mark Connection", def: "Menandai koneksi baru yang masuk." },
                    { term: "Mark Routing", def: "Menentukan jalur routing berdasarkan tanda koneksi." },
                    { term: "Distance", def: "Nilai prioritas rute. Angka lebih kecil = Lebih prioritas." }
                ],
                points: [
                    "Langkah 1: Buat NAT Masquerade untuk kedua Interface ISP.",
                    "Langkah 2: Mangle - Mark Connection (Input & Forward).",
                    "Langkah 3: Mangle - Mark Routing berdasarkan Mark Connection.",
                    "Langkah 4: IP Route - Arahkan Mark Routing ke Gateway masing-masing.",
                    "Langkah 5: Tambahkan Failover dengan Check Gateway & Distance."
                ],
                quiz: [
                    { q: "Fitur apa untuk menandai paket?", opts: ["NAT", "Filter Rule", "Mangle"], ans: 2, exp: "Mangle digunakan untuk marking packet/connection/routing." }
                ]
            }
        };

        // Checklist Profil Pelajar Pancasila
        const p5Items = [
            { text: "<strong>Bernalar Kritis:</strong> Mampu menganalisis penyebab jalur down.", icon: "fa-brain" },
            { text: "<strong>Mandiri:</strong> Mampu melakukan troubleshooting dasar tanpa bantuan.", icon: "fa-user-clock" },
            { text: "<strong>Kreatif:</strong> Mencari solusi alternatif saat failover gagal.", icon: "fa-lightbulb" }
        ];

        // Global State Variables
        let currentTab = 'konsep';
        let puzzleScore = 0;
        let quizScore = 0;
        let cliScore = 0;
        let failoverScore = 0;

        // --- 2. LOGIKA UTAMA & NAVIGASI ---

        // Handle Login
        document.getElementById('identity-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('student-name').value;
            if(name){
                // Hide Login, Show Main
                document.getElementById('identity-section').classList.add('hidden');
                document.getElementById('top-header').classList.remove('hidden'); 
                document.getElementById('main-content').classList.remove('hidden');
                document.getElementById('main-content').classList.add('fade-in', 'flex'); 
                
                // Initialize First Tab
                renderContent('konsep'); 
                renderP5();
            }
        });

        // Handle Tab Switching
        function switchTab(type) {
            currentTab = type;
            // Update UI Tabs
            ['konsep', 'algo', 'simulasi', 'config'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                if (t === type) { 
                    btn.classList.add('tab-active'); 
                    btn.classList.remove('tab-inactive'); 
                } else { 
                    btn.classList.add('tab-inactive'); 
                    btn.classList.remove('tab-active'); 
                }
            });

            const std = document.getElementById('standard-content');
            const games = document.getElementById('game-center');
            
            // Logic Display Content vs Game
            if(type === 'simulasi') {
                std.classList.add('hidden');
                games.classList.remove('hidden');
                document.getElementById('cp-text').innerText = contentData.simulasi.cp;
            } else {
                games.classList.add('hidden');
                std.classList.remove('hidden');
                renderContent(type);
            }
        }

        // Render Dynamic Content (Teori)
        function renderContent(type) {
            const data = contentData[type];
            document.getElementById('cp-text').innerText = data.cp;
            document.getElementById('material-title').innerText = data.title;
            document.getElementById('video-embed').src = data.video;
            document.getElementById('video-desc').innerText = data.videoDesc;
            
            // Key Points
            const points = document.getElementById('key-points'); 
            points.innerHTML = '';
            data.points.forEach(p => {
                points.innerHTML += `<li class="text-sm text-slate-300 flex gap-2 items-start"><i class="fas fa-check-circle text-green-500 mt-1 shrink-0"></i> <span>${p}</span></li>`;
            });
            
            // Glossary
            const glos = document.getElementById('glossary-container'); 
            glos.innerHTML = '';
            data.glossary.forEach(g => {
                glos.innerHTML += `<div class="bg-slate-900 p-2 border border-slate-700 rounded"><span class="text-cyan-400 font-bold block mb-1">${g.term}</span><span class="text-slate-400 leading-tight">${g.def}</span></div>`;
            });

            // Quiz
            const quiz = document.getElementById('quiz-container'); 
            quiz.innerHTML = '';
            data.quiz.forEach((q, i) => {
                let opts = ''; 
                q.opts.forEach((o, oi) => {
                    opts += `<button onclick="checkQuiz(this, ${oi}, ${q.ans})" class="w-full text-left p-3 border border-slate-700 mb-2 rounded text-xs text-slate-300 hover:bg-slate-700 transition-colors flex items-center justify-between group">
                        <span>${o}</span>
                        <i class="fas fa-check opacity-0 group-hover:opacity-50"></i>
                    </button>`;
                });
                quiz.innerHTML += `<div class="mb-4 pb-2 border-b border-slate-800 last:border-0"><p class="text-xs font-bold text-white mb-2"><i class="fas fa-question-circle text-purple-400"></i> ${q.q}</p>${opts}</div>`;
            });
        }
        
        // Logic Cek Jawaban Quiz
        function checkQuiz(btn, optIdx, ansIdx) {
            // Disable siblings
            const allBtns = btn.parentElement.querySelectorAll('button');
            allBtns.forEach(b => b.disabled = true);
            
            if(optIdx === ansIdx) { 
                btn.classList.remove('hover:bg-slate-700');
                btn.classList.add('bg-green-900', 'text-green-400', 'border-green-500'); 
                btn.innerHTML += ` <i class="fas fa-check-circle"></i>`;
                quizScore += 10; 
            } else { 
                btn.classList.remove('hover:bg-slate-700');
                btn.classList.add('bg-red-900', 'text-red-400', 'border-red-500');
                btn.innerHTML += ` <i class="fas fa-times-circle"></i>`;
            }
        }

        function renderP5() {
            const c = document.getElementById('p5-checklist-container'); 
            c.innerHTML = '';
            p5Items.forEach(i => {
                c.innerHTML += `<label class="flex gap-3 items-center bg-slate-900 p-3 rounded border border-slate-700 cursor-pointer hover:bg-slate-800 transition">
                    <input type="checkbox" class="w-4 h-4 accent-purple-500 rounded focus:ring-purple-500 ring-offset-slate-900">
                    <span class="text-xs text-slate-300 flex-1">${i.text}</span>
                    <i class="fas ${i.icon} text-slate-600"></i>
                </label>`;
            });
        }

        // --- 3. GAME LOGIC ---

        function switchGame(gameType) {
            // Hide all, Show selected
            ['puzzle', 'cli', 'failover'].forEach(g => {
                const area = document.getElementById(`game-${g}-area`);
                const btn = document.getElementById(`btn-game-${g}`);
                if(g === gameType) {
                    area.classList.remove('hidden');
                    btn.classList.add('game-btn-active'); btn.classList.remove('game-btn-inactive');
                } else {
                    area.classList.add('hidden');
                    btn.classList.add('game-btn-inactive'); btn.classList.remove('game-btn-active');
                }
            });
        }

        // === GAME 1: PUZZLE (DRAG & DROP) ===
        const draggables = document.querySelectorAll('.draggable-source');
        const dropZone = document.getElementById('target-container');
        
        draggables.forEach(d => { 
            d.addEventListener('dragstart', () => d.classList.add('dragging', 'opacity-50')); 
            d.addEventListener('dragend', () => {
                d.classList.remove('dragging', 'opacity-50'); 
                validatePuzzle();
            }); 
        });
        
        dropZone.addEventListener('dragover', e => { 
            e.preventDefault(); 
            const after = getDragAfterElement(dropZone, e.clientY); 
            const d = document.querySelector('.dragging'); 
            if(!d) return;
            if(!after) dropZone.appendChild(d); 
            else dropZone.insertBefore(d, after); 
            document.getElementById('placeholder-text').style.display='none'; 
        });

        function getDragAfterElement(c, y) { 
            return [...c.querySelectorAll('.draggable-source:not(.dragging)')].reduce((closest, child) => { 
                const box = child.getBoundingClientRect(); 
                const offset = y - box.top - box.height/2; 
                return offset < 0 && offset > closest.offset ? {offset, element: child} : closest; 
            }, {offset: Number.NEGATIVE_INFINITY}).element; 
        }

        function validatePuzzle() {
            const ord = [...dropZone.querySelectorAll('.draggable-source')].map(el => el.dataset.id);
            const feedback = document.getElementById('puzzle-feedback');
            
            // Logika Sederhana: Harus diawali "/ip route add" (ID 1)
            // Idealnya urutan: 1 (ip route), 2/3/4/5 (param), tapi kita cek ID 1 di awal saja untuk simplifikasi
            if(ord.length === 5) {
                if(ord[0] === "1") { 
                    puzzleScore = 100; 
                    feedback.innerText = "‚úÖ SYNTAX VALID! SCRIPT ACCEPTED."; 
                    feedback.className = "mt-3 text-xs text-center text-green-400 block p-2 bg-green-900/30 rounded border border-green-500"; 
                } else { 
                    puzzleScore = 50; 
                    feedback.innerText = "‚ùå SYNTAX ERROR: Command must start with /ip route"; 
                    feedback.className = "mt-3 text-xs text-center text-red-400 block p-2 bg-red-900/30 rounded border border-red-500"; 
                }
            }
        }

        // === GAME 2: CLI RUSH (TYPING) ===
        const cliCommands = [
            "check-gateway=ping", 
            "per-connection-classifier", 
            "distance=1", 
            "mark-routing", 
            "chain=prerouting", 
            "action=mark-connection", 
            "gateway=8.8.8.8", 
            "ip route print", 
            "interface print detail"
        ];
        let cliTimer, cliTimeLeft;
        let cliGameActive = false;

        function startCliGame() {
            if(cliGameActive) return;
            cliGameActive = true; cliScore = 0;
            document.getElementById('cli-score').innerText = "0";
            document.getElementById('cli-input').disabled = false;
            document.getElementById('cli-input').focus();
            document.getElementById('btn-start-cli').innerText = "SESSION ACTIVE... KEEP TYPING!";
            document.getElementById('btn-start-cli').classList.add('bg-slate-700', 'text-slate-500');
            nextCliRound();
        }

        function nextCliRound() {
            const target = cliCommands[Math.floor(Math.random() * cliCommands.length)];
            document.getElementById('cli-target').innerText = target;
            document.getElementById('cli-input').value = '';
            document.getElementById('cli-message').innerText = "";
            
            cliTimeLeft = 100; 
            document.getElementById('cli-timer-bar').style.width = '100%';
            
            clearInterval(cliTimer);
            cliTimer = setInterval(() => {
                cliTimeLeft -= 2.5; // Speed adjustment
                document.getElementById('cli-timer-bar').style.width = cliTimeLeft + '%';
                if(cliTimeLeft <= 0) endGameCli("CONNECTION TIMED OUT!");
            }, 100);
        }

        document.getElementById('cli-input').addEventListener('input', (e) => {
            if(!cliGameActive) return;
            if(e.target.value.toLowerCase().trim() === document.getElementById('cli-target').innerText.toLowerCase().trim()) {
                cliScore += 100; 
                document.getElementById('cli-score').innerText = cliScore;
                document.getElementById('cli-score').classList.add('scale-150');
                setTimeout(() => document.getElementById('cli-score').classList.remove('scale-150'), 200);
                nextCliRound();
            }
        });

        function endGameCli(msg) {
            clearInterval(cliTimer); 
            cliGameActive = false;
            document.getElementById('cli-input').disabled = true;
            document.getElementById('cli-message').innerText = msg;
            document.getElementById('btn-start-cli').innerText = "RESTART CLI SESSION";
            document.getElementById('btn-start-cli').classList.remove('bg-slate-700', 'text-slate-500');
        }

        // === GAME 3: FAILOVER REFLEX (CLICK REACTION) ===
        let isp1Active = true;
        let isp1Online = true; // State ISP 1
        let failoverGameActive = false;
        let failoverTimer;

        function startFailoverGame() {
            if(failoverGameActive) return;
            failoverGameActive = true;
            failoverScore = 0;
            isp1Online = true;
            document.getElementById('failover-score').innerText = "0";
            document.getElementById('btn-start-failover').classList.add('hidden');
            document.getElementById('failover-msg').innerText = "MONITORING TRAFFIC...";
            updateIspVisuals();
            
            // Randomly toggle ISP 1 status loop
            failoverTimer = setInterval(() => {
                // 40% chance to flip status
                if(Math.random() > 0.6) {
                    isp1Online = !isp1Online;
                    updateIspVisuals();
                }
            }, 1500); // Check every 1.5 seconds
            
            // Game duration 30s
            setTimeout(() => {
                clearInterval(failoverTimer);
                failoverGameActive = false;
                document.getElementById('failover-msg').innerText = "SESSION ENDED.";
                document.getElementById('btn-start-failover').classList.remove('hidden');
                document.getElementById('btn-start-failover').innerText = "RESTART MONITORING";
            }, 30000);
        }

        function updateIspVisuals() {
            const stat1 = document.getElementById('isp1-status');
            const btn1 = document.getElementById('btn-isp1');
            
            if(isp1Online) {
                stat1.innerText = "ISP 1: ONLINE";
                stat1.className = "mb-2 text-xs font-bold bg-green-900 text-green-400 py-1 rounded shadow";
                btn1.className = "isp-btn w-full h-32 bg-slate-800 border-2 border-green-500 rounded-lg flex flex-col items-center justify-center gap-2 hover:bg-slate-700 group relative";
            } else {
                stat1.innerText = "ISP 1: RTO (DOWN)";
                stat1.className = "mb-2 text-xs font-bold bg-red-900 text-red-400 py-1 rounded animate-pulse shadow";
                btn1.className = "isp-btn w-full h-32 bg-slate-800 border-2 border-red-500 rounded-lg flex flex-col items-center justify-center gap-2 hover:bg-slate-700 group relative";
            }
        }

        function routePacket(clickedIsp) {
            if(!failoverGameActive) return;
            
            const msg = document.getElementById('failover-msg');
            let points = 0;

            // Logic Failover:
            // Jika ISP 1 Online -> HARUS KLIK ISP 1 (Primary)
            // Jika ISP 1 Offline -> HARUS KLIK ISP 2 (Backup)
            
            if (clickedIsp === 1) {
                if (isp1Online) {
                    points = 10;
                    msg.innerText = "‚úÖ TRAFFIC SENT VIA PRIMARY";
                    msg.className = "text-center mt-3 text-xs font-bold h-4 text-green-400";
                } else {
                    points = -20;
                    msg.innerText = "‚ùå PACKET LOST! PRIMARY IS DOWN!";
                    msg.className = "text-center mt-3 text-xs font-bold h-4 text-red-400";
                    navigator.vibrate(200); // Haptic feedback on mobile
                }
            } else if (clickedIsp === 2) {
                if (!isp1Online) {
                    points = 10;
                    msg.innerText = "‚úÖ FAILOVER SUCCESS (BACKUP USED)";
                    msg.className = "text-center mt-3 text-xs font-bold h-4 text-yellow-400";
                } else {
                    points = -10;
                    msg.innerText = "‚ö†Ô∏è INEFFICIENT! PRIMARY IS AVAILABLE";
                    msg.className = "text-center mt-3 text-xs font-bold h-4 text-orange-400";
                }
            }
            
            failoverScore += points;
            document.getElementById('failover-score').innerText = failoverScore;
        }

        // --- 4. SUBMIT & ADMIN ---
        function submitLKPD() {
            const nama = document.getElementById('student-name').value;
            const kelas = document.getElementById('student-class').value;
            const refleksi = document.getElementById('input-refleksi').value;
            
            const pesan = `*REPORT AIJ PRO - LOAD BALANCING*\n` +
                          `üë§ User: ${nama} (${kelas})\n` +
                          `--------------------------\n` +
                          `üìä *SCORE CARD:*\n` +
                          `üß† Quiz Teori: ${quizScore}\n` +
                          `üß© Logic Puzzle: ${puzzleScore}\n` +
                          `‚å®Ô∏è CLI Speed: ${cliScore}\n` +
                          `‚ö° Reflex Failover: ${failoverScore}\n` +
                          `--------------------------\n` +
                          `üìù *Catatan:*\n${refleksi || "-"}\n\n` +
                          `_Sent via AIJ PRO Virtual Lab_`;
            
            if(confirm("Apakah data sudah benar? Klik OK untuk membuka WhatsApp.")) {
                window.open(`https://wa.me/6285709808532?text=${encodeURIComponent(pesan)}`, '_blank');
            }
        }

        function openAdminModal() { document.getElementById('admin-modal').classList.remove('hidden'); }
        function closeAdminModal() { document.getElementById('admin-modal').classList.add('hidden'); }
        
        function checkPin() { 
            const pin = document.getElementById('admin-pin').value;
            if(pin === "270302") {
                closeAdminModal(); 
                document.getElementById('teacher-dashboard').classList.remove('hidden');
                
                // Simulate Log Data
                const nama = document.getElementById('student-name').value || "Guest User";
                const tbody = document.getElementById('student-data-body');
                tbody.innerHTML = `
                    <tr class="bg-slate-800 border-b border-slate-700">
                        <td class="p-3 text-white font-bold">${nama}</td>
                        <td class="p-3">
                            <span class="bg-blue-900 text-blue-300 text-[10px] px-1 rounded">Q:${quizScore}</span>
                            <span class="bg-green-900 text-green-300 text-[10px] px-1 rounded">P:${puzzleScore}</span>
                            <span class="bg-red-900 text-red-300 text-[10px] px-1 rounded">R:${failoverScore}</span>
                        </td>
                    </tr>`;
                document.getElementById('no-data-msg').classList.add('hidden');
            } else {
                alert("ACCESS DENIED: Invalid PIN");
                document.getElementById('admin-pin').value = '';
            }
        }
        
        function closeDashboard() { document.getElementById('teacher-dashboard').classList.add('hidden'); }
        function clearData() { 
            document.getElementById('student-data-body').innerHTML = '';
            document.getElementById('no-data-msg').classList.remove('hidden');
        }
    </script>
</body>
</html>
 Buat aplikasi nya
